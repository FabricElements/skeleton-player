<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-icons/iron-icons.html">
<link rel="import" href="../iron-icons/av-icons.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../paper-progress/paper-progress.html">
<link rel="import" href="skeleton-player-slider.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">

<!--<link rel="import" href="skeleton-player-behavior.html">-->

<!--
`skeleton-player-controls`
Custom Audio player using material design

@group skeleton-player
@pseudoElement skeleton-player-controls
@demo demo/index.html
-->

<dom-module id="skeleton-player-controls">
  <template>
    <style>
      :host {
        display: block;
        @apply(--layout);
        @apply(--layout-justified);
        @apply(--layout-center);
        cursor: default;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        background-color: var(--skeleton-player-slider-container-color, --paper-grey-100);
      }

      paper-icon-button {
        width: 50px;
        height: 50px;
        color: var(--skeleton-player-button-color, #ffffff);
        background-color: var(--skeleton-player-slider-active-color, --paper-grey-900);
      }

      skeleton-player-slider {
        @apply(--layout-flex-auto);
      }

      paper-icon-button.ended-true {
        display: none;
      }
    </style>
    <template is="dom-if" if="{{controls}}">
      <paper-icon-button icon="av:replay" on-tap="play" hidden$="{{!ended}}"></paper-icon-button>
      <paper-icon-button icon="av:play-arrow"
                         on-tap="play"
                         hidden$="{{playing}}"
                         class$="ended-{{ended}}"></paper-icon-button>
      <paper-icon-button icon="av:pause"
                         on-tap="pause"
                         hidden$="{{!playing}}"
      ></paper-icon-button>
      <skeleton-player-slider value="{{progress}}"
                              secondary-progress="{{secondaryProgress}}"
                              immediate-value="{{immediateValue}}"></skeleton-player-slider>
    </template>
  </template>

  <script>
    Polymer({

      is: 'skeleton-player-controls',
      properties: {
        progress: {
          type: Number,
          notify: true
        },
        ended: {
          type: Boolean,
          value: false
        },
        playing: {
          type: Boolean,
          value: false
        },
        paused: {
          type: Boolean,
          value: false
        },
      },
      listeners: {
        "change": "change"
      },
      behaviors: [
//        Fabric.SkeletonPlayerBehavior
      ],
      play: function () {
        this.fire('play');
      },
      pause: function () {
        this.fire('pause');
      },
      change: function () {
        let position = this.progress / 100;
        this.fire('change-progress', position);
        if (!this.playing) this.fire('play');
      }
    });
  </script>
</dom-module>
